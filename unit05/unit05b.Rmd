---
title: 第五B單元：基礎統計 with R
author: 中山大學管理學院 卓雍然
date: "`r Sys.time()`"
output: 
  html_document:
    highlight: pygments
    theme: flatly
    css: style.css
---

```{r results='hide', message=FALSE, warning=FALSE, echo=F}
# 這些程式碼設定網頁的格式，並安裝、載入一些基本的套件，請大家不要去改動<br>
rm(list=ls(all=T))
knitr::opts_chunk$set(comment = NA)
knitr::opts_knit$set(global.par = TRUE)
par(cex=0.8)
options(scipen=20, digits=5, width=80)
if(!require(pacman)) install.packages("pacman")
```
<hr>

**單元摘要：**使用R複習並練習操作「基礎統計」

* 統計量 Statistics
    + 基本的統計量(函數)
* R內建的機率分布與其功能函數 
    + 機率分布與功能函數 
* 常見的連續的機率分布 Continuous Probability Distributions
    + 常態分布 Normal Distributions
    + 卡方分布 Chi-Square Distribution
    + F分布 F Distribution
    + Student-$t$ Distribution
    + Uniform Distribution
* 常見的離散的機率分布 Discrete Probability Distributions
    + 二項分布 Binomial Dist.
    + 超幾何分布 Hypergeometric Dist.
    + 布瓦松分布 Poisson Dist.
    + 幾何分布 Geometric Dist.
    + 負二項分布 Negative Binominal Dist.
    + 多項分布 Multinomial Dist.
* 機率分布的應用
    + Applications of Normal Dist.
    + Applications of Poisson Dist.

<br>
```{r results='hide', message=FALSE, warning=FALSE}
pacman::p_load(dplyr)
```
<hr>

### 【A】統計量 Statistics

統計量(statistics)就是一群數值的摘要(summary)，常用的統計量有：

* 平均值 Mean：`mean()`
* 中位數：`median()`
* 最大值：`max()`
* 最小值：`min()`
* 標準差 Std. Deviation：`sd()`
* 變異數 Variance：`var()`
* 百分位：`quantile()`

我們先隨機在零到一之間產生50個的亂數 
```{r}
X = runif(50)
X
```
```{r}
summary(X)
```
```{r}
c(sd(X), var(X))
```
```{r}
quantile(X, seq(0,1,1/10))
```
除了這些統計量之外，我們也可以利用圖形來幫助我們(對於這一群數字)建立一個整體性的認識
```{r}
hist(X, 10, col='darkcyan', border='gray')
```
<hr>

### 【B】R內建的機率分布與其功能函數
R有一群內建的機率分布 

* beta : `dbeta()`
* binomial : `dbinom()`
* Cauchy : `dcauchy()`
* chi-squared : `dchisq()`
* exponential : `dexp()`
* F : `df()`
* gamma : `dgamma()`
* geometric : `dgeom
* hypergeometric : `dhyper()`
* log-normal : `dlnorm()`
* multinomial : `dmultinom()`
* negative binomial : `dnbinom()`
* normal : `dnorm()`
* Poisson : `dpois()`
* Student's t : `dt()`
* uniform : `dunif()`
* Weibull : `dweibull()`
* ...其他幾乎所有叫得出名字的機率分布都可以透過套件外掛

```{r eval=F}
?distributions
```

每一種機率分布都有四個功能函數：

* `d<name>()` : density or probability function
* `p<name>()` : cumulative density function
* `q<name>()` : quantile function
* `r<name>()` : random sampling

##### B1. `d<name>: d for density` 機率密度函數 (PDF) 
`d<name>`用來求取對應到某一數值的機率密度，
給定機率分佈的種類和它所需要的「參數」，我們就能確定「值域」之中每一點的機率密度；
`d<name>`通常用來畫機率密度函數
```{r fig.height=5, fig.width=8}
par(mfrow=c(2,2), mar=c(2,4,3,2), cex=0.7)
curve(dnorm(x,mean=50,sd=15),0,100,main="Normal")
curve(dunif(x,min=0,max=100),0,100,main="Uniform")
curve(dlnorm(x,meanlog=log(50),sdlog=1.5),0,100,main="Log-Normal")
curve(dexp(x,rate=0.05),0,100,main="Exponential")
```
<br>

傳回`Normal[mean=40,sd=15]`這個機率密度函數在`x = 40`這一點的值
```{r}
dnorm(x=40, mean=50, sd=15)
```

傳回`Normal[mean=40,sd=15]`這個機率密度函數在`x = c(0,20,40,60,80,100)`這些點的值
```{r}
dnorm(seq(0,100,20), mean=50, sd=15)
```

畫出機率分布的形狀
```{r fig.height=2, fig.width=8}
par(mfrow=c(1,2), mar=c(2,2,1,2),cex=0.7)
x = seq(0,100,1)
y = dnorm(x, mean=50, sd=15) 
plot(x, y, type='l')
# curve() is a easier way to plot a function (or expresion) of x
curve(dnorm(x,mean=50,sd=15),0,100)
```
<br>

##### B2. `r<name>: r for random` 隨機抽樣 
`r<name>`常用來從給定的機率分佈之中隨機抽出樣本
```{r}
norm50 = rnorm(n=50, mean=50, sd=10)
unif50 = runif(n=50, min=0, max=100)
```

```{r fig.height=2, fig.width=8}
par(mfrow=c(1,2), mar=c(2,2,2,2),cex=0.6)
hist(norm50,breaks=10)
hist(unif50,breaks=10)
```

```{r fig.height=6, fig.width=8}
par(mfrow=c(3,2), mar=c(3,2,2,2),cex=0.6)
for(n in c(20, 200, 2000)) {
  hist(rnorm(n, mean=50, sd=10),breaks=10,main=paste("Normal",n))
  hist(runif(n, min=0, max=100),breaks=10,main=paste("Uniform",n))
  }
```
<br>

##### B3. `p<name>: p for probability` 累積機率函數 (CDF)
`p<name>`求取變數落在某數值區間的機率，給定機率分佈，我們常會想要知道目標變數會落在某一個數值空間的機率，如果隨機變數`X ~ Normal[mu=50, sd=10]`，`pnorm(x=55, 50, 10)`會傳回`X < 55`的機率；
```{r}
mu=50; sd=10
pnorm(55, mu, sd)
```

<p class="qiz">
<span style="font-size:24px">`r "\U1F5FF"` 問題討論：</span><br>
A. 如果隨機變數`X ~ Normal[mu=100, sd=20]`，請求出以下機率： <br>
&emsp; ■ `P[X < 110]`<br>
&emsp; ■ `P[130 > X > 110]`<br>
&emsp; ■ `P[X > 130]`<br>
B. 請畫出圖形來解釋你的運算
</p class="qiz">

```{r}
x1 = 90; x2 = 130
p1 = pnorm(x1,100,20); p2 = pnorm(x2,100,20)
c(p1, p2 - p1, 1 - p2)
```

```{r fig.height=2, fig.width=8}
par(mfrow=c(1,2), mar=c(2,2,2,2),cex=0.7)
curve(dnorm(x,100,20),40,160,main="PDF")
abline(v=c(x1,x2),col='gray',lty=3)
curve(pnorm(x,100,20),40,160,main="CDF")
abline(v=c(x1,x2),col='gray',lty=3)
abline(h=c(p1,p2),col='pink')
```
<br>

##### B4. `q<name>: q for quantile` 百分位函數 
`q<name>`通常用來求取對應到某一機率的臨界值，如果隨機變數`X ~ Normal[mu, sd]`，`qnorm(p=0.8, mu, sd)`會傳回`Pr[X < x1] = 0.8`的臨界值`x1`；
```{r}
qnorm(p=0.8, 100, 20)
```

<p class="qiz">
<span style="font-size:24px">`r "\U1F5FF"` 問題討論：</span><br>
A. 如果隨機變數`X ~ Normal[mu=100, sd=20]`，請求`X`的90%信賴區間 <br>
B. 請畫出圖形來解釋你的運算
</p class="qiz">

```{r}
interval = c(0.05, 0.95)
Q = qnorm(interval, 100, 20); Q
```

```{r fig.height=2, fig.width=8}
curve(dnorm(x,100,20),40,160,main="PDF")
abline(v=c(Q[1],Q[2]),col='gray',lty=3)
curve(pnorm(x,100,20),40,160,main="CDF")
abline(v=c(Q[1],Q[2]),col='gray',lty=3)
abline(h=interval,col='pink')
```



<br><hr>
### 【C】




